<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Folder‚ÄîFile Relationship Dashboard</title>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
<script src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>
<style>
  :root{--bg:#071019;--card:#0c1116;--muted:#9fb6cc;--accent:#8bd8ff;--panelbg:#071219}
  body{margin:0;font-family:Inter,Arial,Helvetica,sans-serif;background:var(--bg);color:#e6eef8}
  header{padding:18px 22px;background:linear-gradient(90deg,#081226,#071726);box-shadow:0 2px 10px rgba(0,0,0,0.5)}
  header h1{margin:0;font-weight:600;font-size:18px;color:var(--accent)}
  .wrap{padding:16px}
  .grid{display:grid;grid-template-columns:1.3fr 0.9fr;grid-gap:14px;align-items:start}
  .card{background:var(--card);border:1px solid #1a2432;border-radius:12px;padding:12px;box-shadow:0 8px 26px rgba(0,0,0,.45)}
  .card h2{margin:6px 0 10px 0;font-size:15px;color:var(--accent)}
  .netwrap{height:640px;border-radius:10px;border:2px solid #142030;overflow:hidden;background:#061018;padding:8px}
  #mynetwork{width:100%;height:100%;background:transparent}
  .portrait{background:#07151b;border-radius:10px;padding:14px;height:640px;overflow:auto;border:1px solid #131b25}
  .kv{
    display:flex;gap:8px;margin:8px 0;font-size:14px;align-items:center;
  }
  .kv b{color:var(--accent);min-width:140px}
  .chips{display:flex;gap:8px;flex-wrap:wrap}
  .chip{background:#10262f;border:1px solid #183443;color:#cfe9ff;padding:6px 9px;border-radius:999px;font-size:13px}
  .muted{color:var(--muted);font-size:13px}
  .divider{height:1px;background:#142030;margin:12px 0}
  #chart{height:360px}
  .meta-block{background:#071219;border:1px solid #142030;padding:10px;border-radius:8px;white-space:pre-wrap;font-family:monospace;font-size:13px;color:#cfe9ff}
  footer{text-align:center;color:#8aa7c2;font-size:12px;padding:10px;margin-top:12px}
  /* legend */
  .legend{display:flex;gap:8px;align-items:center;margin-bottom:8px}
  .legend .item{display:flex;gap:6px;align-items:center;font-size:13px}
  .legend .dot{width:14px;height:14px;border-radius:50%;display:inline-block}
</style>
</head>
<body>
  <header><h1>üìÅ Folder‚ÄîFile Relationship Dashboard</h1></header>
  <div class="wrap">
    <div class="grid">
      <div class="card">
        <h2>Network ‚Äî folders (large teal) & files (smaller colored by type)</h2>
        <div class="muted" style="margin-bottom:8px">Click nodes to inspect; folder nodes show aggregated stats. Cross-folder edges show why (similarity / keywords / same type).</div>
        <div class="netwrap"><div id="mynetwork"></div></div>
      </div>
      <div class="card portrait" id="portrait">
        <div class="muted">Click a folder or file node, or click a folder bar in the chart to inspect details here.</div>
      </div>
    </div>

    <div class="card" style="margin-top:14px;">
      <h2>Folder Distribution ‚Äî Words & Top-keyword frequency</h2>
      <div id="chart"></div>
      <div class="muted" style="margin-top:8px">Click a bar to jump to folder details.</div>
    </div>
  </div>

  <footer>Generated by visualizer_v3 ‚Äî files in <code>D:\folder_chunk.py\outputs</code></footer>

<script>
  // ------------------ Data injected from Python ------------------
  const NODES = [{"id": "F1", "label": "taskfol", "title": "<b>taskfol</b><br><b>Files:</b> 9<br><b>Words:</b> 699981", "color": {"background": "#0ea5a4", "border": "#056d67"}, "group": "folder", "value": 100.39784061422834}, {"id": "F2", "label": "taskfolder_1", "title": "<b>taskfolder_1</b><br><b>Files:</b> 5<br><b>Words:</b> 914520", "color": {"background": "#0ea5a4", "border": "#056d67"}, "group": "folder", "value": 114.75664686631445}, {"id": "F3", "label": "taskfolder_2", "title": "<b>taskfolder_2</b><br><b>Files:</b> 4<br><b>Words:</b> 9166", "color": {"background": "#0ea5a4", "border": "#056d67"}, "group": "folder", "value": 18}, {"id": "1", "label": "annual-enterprise-survey-2024-financial-year-provisional-size-bands.csv", "title": "<b>annual-enterprise-survey-2024-financial-year-provisional-size-bands.csv</b><br><b>Folder:</b> D:\\taskfol<br><b>Words:</b> 597864", "color": {"background": "#2563eb", "border": "#111827"}, "group": "file", "value": 61.857332629204116, "folder": "D:\\taskfol"}, {"id": "2", "label": "articles-limited-by-shares.docx", "title": "<b>articles-limited-by-shares.docx</b><br><b>Folder:</b> D:\\taskfol<br><b>Words:</b> 7355", "color": {"background": "#16a34a", "border": "#111827"}, "group": "file", "value": 6.860903730559117, "folder": "D:\\taskfol"}, {"id": "3", "label": "E-commerce Customer Behavior - Sheet1.csv", "title": "<b>E-commerce Customer Behavior - Sheet1.csv</b><br><b>Folder:</b> D:\\taskfol<br><b>Words:</b> 2626", "color": {"background": "#2563eb", "border": "#111827"}, "group": "file", "value": 6, "folder": "D:\\taskfol"}, {"id": "4", "label": "HR Policy Manual 2023 (8).pdf", "title": "<b>HR Policy Manual 2023 (8).pdf</b><br><b>Folder:</b> D:\\taskfol<br><b>Words:</b> 58464", "color": {"background": "#e11d48", "border": "#111827"}, "group": "file", "value": 19.34346401242549, "folder": "D:\\taskfol"}, {"id": "5", "label": "sample2.txt", "title": "<b>sample2.txt</b><br><b>Folder:</b> D:\\taskfol<br><b>Words:</b> 1", "color": {"background": "#f59e0b", "border": "#111827"}, "group": "file", "value": 6, "folder": "D:\\taskfol"}, {"id": "6", "label": "sample3.json", "title": "<b>sample3.json</b><br><b>Folder:</b> D:\\taskfol<br><b>Words:</b> 179", "color": {"background": "#8b5cf6", "border": "#111827"}, "group": "file", "value": 6, "folder": "D:\\taskfol"}, {"id": "7", "label": "sample3.txt", "title": "<b>sample3.txt</b><br><b>Folder:</b> D:\\taskfol<br><b>Words:</b> 1", "color": {"background": "#f59e0b", "border": "#111827"}, "group": "file", "value": 6, "folder": "D:\\taskfol"}, {"id": "8", "label": "SBI_in.pdf", "title": "<b>SBI_in.pdf</b><br><b>Folder:</b> D:\\taskfol<br><b>Words:</b> 24548", "color": {"background": "#e11d48", "border": "#111827"}, "group": "file", "value": 12.534241101877688, "folder": "D:\\taskfol"}, {"id": "9", "label": "SEBI Booklet.pdf", "title": "<b>SEBI Booklet.pdf</b><br><b>Folder:</b> D:\\taskfol<br><b>Words:</b> 8943", "color": {"background": "#e11d48", "border": "#111827"}, "group": "file", "value": 7.5653949004662016, "folder": "D:\\taskfol"}, {"id": "10", "label": "0e21835a42a6df2405496f62647058ff855743c1.pdf", "title": "<b>0e21835a42a6df2405496f62647058ff855743c1.pdf</b><br><b>Folder:</b> D:\\taskfolder_1<br><b>Words:</b> 1907", "color": {"background": "#e11d48", "border": "#111827"}, "group": "file", "value": 6, "folder": "D:\\taskfolder_1"}, {"id": "11", "label": "281928eff64137efdd144a833c81ad0ee45284c1.pdf", "title": "<b>281928eff64137efdd144a833c81ad0ee45284c1.pdf</b><br><b>Folder:</b> D:\\taskfolder_1<br><b>Words:</b> 2212", "color": {"background": "#e11d48", "border": "#111827"}, "group": "file", "value": 6, "folder": "D:\\taskfolder_1"}, {"id": "12", "label": "2RE7KOL5KV5FFCUG6CYUVEFF4KIUZN2V.pdf", "title": "<b>2RE7KOL5KV5FFCUG6CYUVEFF4KIUZN2V.pdf</b><br><b>Folder:</b> D:\\taskfolder_1<br><b>Words:</b> 2686", "color": {"background": "#e11d48", "border": "#111827"}, "group": "file", "value": 6, "folder": "D:\\taskfolder_1"}, {"id": "13", "label": "customers-100.csv", "title": "<b>customers-100.csv</b><br><b>Folder:</b> D:\\taskfolder_1<br><b>Words:</b> 2361", "color": {"background": "#2563eb", "border": "#111827"}, "group": "file", "value": 6, "folder": "D:\\taskfolder_1"}, {"id": "14", "label": "US_STATE_recipes.json", "title": "<b>US_STATE_recipes.json</b><br><b>Folder:</b> D:\\taskfolder_1<br><b>Words:</b> 905354", "color": {"background": "#8b5cf6", "border": "#111827"}, "group": "file", "value": 76.1200735680149, "folder": "D:\\taskfolder_1"}, {"id": "15", "label": "0e21835a42a6df2405496f62647058ff855743c1.pdf", "title": "<b>0e21835a42a6df2405496f62647058ff855743c1.pdf</b><br><b>Folder:</b> D:\\taskfolder_2<br><b>Words:</b> 1907", "color": {"background": "#e11d48", "border": "#111827"}, "group": "file", "value": 6, "folder": "D:\\taskfolder_2"}, {"id": "16", "label": "281928eff64137efdd144a833c81ad0ee45284c1.pdf", "title": "<b>281928eff64137efdd144a833c81ad0ee45284c1.pdf</b><br><b>Folder:</b> D:\\taskfolder_2<br><b>Words:</b> 2212", "color": {"background": "#e11d48", "border": "#111827"}, "group": "file", "value": 6, "folder": "D:\\taskfolder_2"}, {"id": "17", "label": "2RE7KOL5KV5FFCUG6CYUVEFF4KIUZN2V.pdf", "title": "<b>2RE7KOL5KV5FFCUG6CYUVEFF4KIUZN2V.pdf</b><br><b>Folder:</b> D:\\taskfolder_2<br><b>Words:</b> 2686", "color": {"background": "#e11d48", "border": "#111827"}, "group": "file", "value": 6, "folder": "D:\\taskfolder_2"}, {"id": "18", "label": "customers-100.csv", "title": "<b>customers-100.csv</b><br><b>Folder:</b> D:\\taskfolder_2<br><b>Words:</b> 2361", "color": {"background": "#2563eb", "border": "#111827"}, "group": "file", "value": 6, "folder": "D:\\taskfolder_2"}];
  const EDGES = [{"from": "F2", "to": "F3", "color": {"color": "#38bdf8"}, "width": 8.530034508113392, "title": "<b>Relation:</b> folder-similarity<br><b>Score:</b> 0.94"}, {"from": "F1", "to": "1", "color": {"color": "#94a3b8"}, "width": 1.0, "title": "contains 1"}, {"from": "F1", "to": "2", "color": {"color": "#94a3b8"}, "width": 1.0, "title": "contains 2"}, {"from": "F1", "to": "3", "color": {"color": "#94a3b8"}, "width": 1.0, "title": "contains 3"}, {"from": "F1", "to": "4", "color": {"color": "#94a3b8"}, "width": 1.0, "title": "contains 4"}, {"from": "F1", "to": "5", "color": {"color": "#94a3b8"}, "width": 1.0, "title": "contains 5"}, {"from": "F1", "to": "6", "color": {"color": "#94a3b8"}, "width": 1.0, "title": "contains 6"}, {"from": "F1", "to": "7", "color": {"color": "#94a3b8"}, "width": 1.0, "title": "contains 7"}, {"from": "F1", "to": "8", "color": {"color": "#94a3b8"}, "width": 1.0, "title": "contains 8"}, {"from": "F1", "to": "9", "color": {"color": "#94a3b8"}, "width": 1.0, "title": "contains 9"}, {"from": "F2", "to": "10", "color": {"color": "#94a3b8"}, "width": 1.0, "title": "contains 10"}, {"from": "F2", "to": "11", "color": {"color": "#94a3b8"}, "width": 1.0, "title": "contains 11"}, {"from": "F2", "to": "12", "color": {"color": "#94a3b8"}, "width": 1.0, "title": "contains 12"}, {"from": "F2", "to": "13", "color": {"color": "#94a3b8"}, "width": 1.0, "title": "contains 13"}, {"from": "F2", "to": "14", "color": {"color": "#94a3b8"}, "width": 1.0, "title": "contains 14"}, {"from": "F3", "to": "15", "color": {"color": "#94a3b8"}, "width": 1.0, "title": "contains 15"}, {"from": "F3", "to": "16", "color": {"color": "#94a3b8"}, "width": 1.0, "title": "contains 16"}, {"from": "F3", "to": "17", "color": {"color": "#94a3b8"}, "width": 1.0, "title": "contains 17"}, {"from": "F3", "to": "18", "color": {"color": "#94a3b8"}, "width": 1.0, "title": "contains 18"}, {"from": "5", "to": "7", "color": {"color": "#38bdf8"}, "width": 8.999999999984002, "title": "<b>Relation:</b> doc-similarity<br><b>Reasons:</b> sim=1.00, same_type"}, {"from": "10", "to": "15", "color": {"color": "#38bdf8"}, "width": 8.999999999983999, "title": "<b>Relation:</b> doc-similarity<br><b>Reasons:</b> sim=1.00, shared_kw=10, same_type"}, {"from": "11", "to": "16", "color": {"color": "#38bdf8"}, "width": 8.999999999984002, "title": "<b>Relation:</b> doc-similarity<br><b>Reasons:</b> sim=1.00, shared_kw=10, same_type"}, {"from": "12", "to": "17", "color": {"color": "#38bdf8"}, "width": 8.999999999984002, "title": "<b>Relation:</b> doc-similarity<br><b>Reasons:</b> sim=1.00, shared_kw=10, same_type"}, {"from": "13", "to": "18", "color": {"color": "#38bdf8"}, "width": 8.999999999984, "title": "<b>Relation:</b> doc-similarity<br><b>Reasons:</b> sim=1.00, shared_kw=10, same_type"}];
  const DETAILS = [{"id": "F1", "title": "taskfol", "type": "folder", "path": "D:\\taskfol", "words": 699981, "file_count": 9, "size_bytes": 19594685, "size_kb": 19135.43, "keywords": ["nan", "dollars", "millions", "services", "total", "assets", "count", "subsidies", "g_100", "c_6", "directors", "meeting"], "metadata": {"folder_path": "D:\\taskfol", "file_count": 9, "top_keywords": ["nan", "dollars", "millions", "services", "total", "assets", "count", "subsidies", "g_100", "c_6", "directors", "meeting"]}, "degree": 9, "preview": "taskfol"}, {"id": "F2", "title": "taskfolder_1", "type": "folder", "path": "D:\\taskfolder_1", "words": 914520, "file_count": 5, "size_bytes": 9481684, "size_kb": 9259.46, "keywords": ["data", "incident", "humanitarian", "incidents", "management", "risk", "organizations", "security", "centre", "organization", "rainfall", "observational"], "metadata": {"folder_path": "D:\\taskfolder_1", "file_count": 5, "top_keywords": ["data", "incident", "humanitarian", "incidents", "management", "risk", "organizations", "security", "centre", "organization", "rainfall", "observational"]}, "degree": 6, "preview": "taskfolder_1"}, {"id": "F3", "title": "taskfolder_2", "type": "folder", "path": "D:\\taskfolder_2", "words": 9166, "file_count": 4, "size_bytes": 3212692, "size_kb": 3137.39, "keywords": ["data", "incident", "humanitarian", "incidents", "management", "risk", "organizations", "security", "centre", "organization", "rainfall", "observational"], "metadata": {"folder_path": "D:\\taskfolder_2", "file_count": 4, "top_keywords": ["data", "incident", "humanitarian", "incidents", "management", "risk", "organizations", "security", "centre", "organization", "rainfall", "observational"]}, "degree": 5, "preview": "taskfolder_2"}, {"id": "1", "title": "annual-enterprise-survey-2024-financial-year-provisional-size-bands.csv", "type": "file", "path": "D:\\taskfol\\annual-enterprise-survey-2024-financial-year-provisional-size-bands.csv", "words": 597864, "size_kb": 2050.01, "keywords": ["nan", "dollars", "millions", "services", "total", "assets", "count", "subsidies", "g_100", "c_6"], "metadata": {"filename": "annual-enterprise-survey-2024-financial-year-provisional-size-bands.csv", "filepath": "D:\\taskfol\\annual-enterprise-survey-2024-financial-year-provisional-size-bands.csv", "size_bytes": 2099215, "size_kb": 2050.01, "modified_at": "Tue Nov  4 11:59:29 2025", "created_at": "Tue Nov  4 12:01:59 2025", "ext": ".csv", "word_count": 597864, "top_keywords": ["nan", "dollars", "millions", "services", "total", "assets", "count", "subsidies"]}, "degree": 1, "preview": "A | Agriculture, Forestry and Fishing | a_0 | Activity unit | 46134 | COUNT | nan | nan | nan | nan | nan | nan A | Agriculture, Forestry and Fishing | a_0 | Rolling mean employees | 0 | COUNT | nan | nan | nan | nan | nan | nan A | Agriculture, Forestry and Fishing | a_0 | Salaries and wages paid | 279 | DOLLARS(millions) | nan | nan | nan | nan | nan | nan A | Agriculture, Forestry and Fishing | a_0 | Sales, government funding, grants and subsidies | 8187 | DOLLARS(millions) | nan | nan | nan | nan | nan | nan A | Agriculture, Forestry and Fishing | a_0 | Total income | 8866 | DOLLARS(millions) | nan | nan | nan | nan | nan | nan A | Agriculture, Forestry and Fishing | a_0 | Total expenditure | 7618 | DOLLARS(millions) | nan | nan | nan | nan | nan | nan A | Agriculture, Forestry and Fis"}, {"id": "2", "title": "articles-limited-by-shares.docx", "type": "file", "path": "D:\\taskfol\\articles-limited-by-shares.docx", "words": 7355, "size_kb": 34.27, "keywords": ["directors", "meeting", "company", "director", "shares", "articles", "general", "chairman", "person", "proxy"], "metadata": {"filename": "articles-limited-by-shares.docx", "filepath": "D:\\taskfol\\articles-limited-by-shares.docx", "size_bytes": 35097, "size_kb": 34.27, "modified_at": "Tue Nov  4 11:52:42 2025", "created_at": "Tue Nov  4 11:53:03 2025", "ext": ".docx", "word_count": 7355, "top_keywords": ["directors", "meeting", "company", "director", "shares", "articles", "general", "chairman"]}, "degree": 1, "preview": "COMPANIES ACT 2006 - PRIVATE COMPANY LIMITED BY SHARES    ARTICLES OF ASSOCIATION    ENTER COMPANY NAME    SCHEDULE 1    MODEL ARTICLES FOR PRIVATE COMPANIES LIMITED BY SHARES    INDEX TO THE ARTICLES    PART 1  INTERPRETATION AND LIMITATION OF LIABILITY    1. Defined terms  2. Liability of members  PART 2  DIRECTORS  DIRECTORS‚Äô POWERS AND RESPONSIBILITIES    3. Directors‚Äô general authority  4. Shareholders‚Äô reserve power  5. Directors may delegate  6. Committees  DECISION-MAKING BY DIRECTORS  7. Directors to take decisions collectively  8. Unanimous decisions  9. Calling a directors‚Äô meeting  10. Participation in directors‚Äô meetings  11. Quorum for directors‚Äô meetings  12. Chairing of directors‚Äô meetings  13. Casting vote  14. Conflicts of interest  15. Records of decisions to be kept  16"}, {"id": "3", "title": "E-commerce Customer Behavior - Sheet1.csv", "type": "file", "path": "D:\\taskfol\\E-commerce Customer Behavior - Sheet1.csv", "words": 2626, "size_kb": 21.12, "keywords": ["male", "female", "unsatisfied", "bronze", "neutral", "gold", "silver", "satisfied", "los", "york"], "metadata": {"filename": "E-commerce Customer Behavior - Sheet1.csv", "filepath": "D:\\taskfol\\E-commerce Customer Behavior - Sheet1.csv", "size_bytes": 21629, "size_kb": 21.12, "modified_at": "Fri Oct 31 04:38:29 2025", "created_at": "Tue Nov  4 12:02:32 2025", "ext": ".csv", "word_count": 2626, "top_keywords": ["male", "female", "unsatisfied", "bronze", "neutral", "gold", "silver", "satisfied"]}, "degree": 1, "preview": "Female | New York | Gold | Satisfied Male | Los Angeles | Silver | Neutral Female | Chicago | Bronze | Unsatisfied Male | San Francisco | Gold | Satisfied Male | Miami | Silver | Unsatisfied Female | Houston | Bronze | Neutral Female | New York | Gold | Satisfied Male | Los Angeles | Silver | Neutral Female | Chicago | Bronze | Unsatisfied Male | San Francisco | Gold | Satisfied Male | Miami | Silver | Unsatisfied Female | Houston | Bronze | Neutral Female | New York | Gold | Satisfied Male | Los Angeles | Silver | Satisfied Female | Chicago | Bronze | Unsatisfied Male | San Francisco | Gold | Satisfied Male | Miami | Silver | Unsatisfied Female | Houston | Bronze | Neutral Female | New York | Gold | Satisfied Male | Los Angeles | Silver | Neutral Female | Chicago | Bronze | Unsatisfied Ma"}, {"id": "4", "title": "HR Policy Manual 2023 (8).pdf", "type": "file", "path": "D:\\taskfol\\HR Policy Manual 2023 (8).pdf", "words": 58464, "size_kb": 15029.39, "keywords": ["iima", "employee", "hr", "policy", "shall", "institute", "leave", "manual", "subscriber", "years"], "metadata": {"filename": "HR Policy Manual 2023 (8).pdf", "filepath": "D:\\taskfol\\HR Policy Manual 2023 (8).pdf", "size_bytes": 15390099, "size_kb": 15029.39, "modified_at": "Mon Nov  3 12:59:11 2025", "created_at": "Tue Nov  4 11:50:29 2025", "ext": ".pdf", "word_count": 58464, "top_keywords": ["iima", "employee", "hr", "policy", "shall", "institute", "leave", "manual"]}, "degree": 1, "preview": "a IIMA HR Policy Manual 2023 HUMAN RESOURCES   POLICY MANUAL STAFF  2023  b IIMA HR Policy Manual 2023 i IIMA HR Policy Manual 2023DECLARATION The objective of this Manual is to compile  the HR policies and  procedures followed in IIMA. It also presents the general rules and  regulations  that govern the employees of the Institute.  This Manual supersedes all previous manuals, handbooks, and  memorandums that may have been issued from time to time on  subjects covered in this Manual. The Institute reserves its right to interpret; change; suspend; cancel;  or dispute, with or without notice; all or any part of what is contained  in the Manual. The Institute will notify all employees of such changes.   In the interpretation of any policies and procedures covered in  the Manual, the Director‚Äô"}, {"id": "5", "title": "sample2.txt", "type": "file", "path": "D:\\taskfol\\sample2.txt", "words": 1, "size_kb": 2.0, "keywords": [], "metadata": {"filename": "sample2.txt", "filepath": "D:\\taskfol\\sample2.txt", "size_bytes": 2048, "size_kb": 2.0, "modified_at": "Tue Nov  4 11:54:41 2025", "created_at": "Tue Nov  4 12:01:59 2025", "ext": ".txt", "word_count": 1, "top_keywords": []}, "degree": 2, "preview": "vfuxeoocymlssftujqqqoaqzkcicuxmuuyzyrixyzaqgbwhdvieezhsdutgpkuwczyzipjkgxnwunxjklvjfyffvjuyqkyoawjmgvkxopvhvoobhftirlgknbvsckgzfbqjneioeelnabbldqkgjfhynwvhxzvldyzudtlrdvfzocszwffpbbjklmrwvfvbhzhhiexhofretspjjpmkeoxtsywoamonanaupqlafufckqhvtopgkfjrnkvohwtzjbttupqoufheheramyjkrxsrfcjripsamwmciawlwmsskeedlnzcvxxjztdfsmieynzvtxtzqudlzpmmfjjpmknerdymdqwkpvtwspqpsxpaggcqbtaapzgjccnnbrgfdkfctnjwmrjjxgkjscaujmzbfasddxaidaooyletrczgzvdaxgzkfrygtwjxqtxsottqroakfrdjyespkersydbtsnkqcacqcuyhqqmgfizyswesfclwpwcmikedktmawaapjzphecifmgydckzaibzivwyohdhvoejomknwjqkyvrdfqxtxxrtoaseubqklxtsvbsukhwosotfscveushflxlpqjfrkyddsfriujdkpemkuuftlokuxevtklofvtvdcfugzjkofpwzijyxuxoiujiefsbxsameossgaejexkkmgkxjfreoedxxtexdbkvystnbvaklcpbjezswoglgetdiryeasxdutbpdtnnkxufehmofulgydfclqazrpzlkspvfbfdhsfcqvkwztivzlqldfxtmad"}, {"id": "6", "title": "sample3.json", "type": "file", "path": "D:\\taskfol\\sample3.json", "words": 179, "size_kb": 2.36, "keywords": ["false", "true", "real", "quite", "meat", "stove", "dark", "lot", "slide", "stiff"], "metadata": {"filename": "sample3.json", "filepath": "D:\\taskfol\\sample3.json", "size_bytes": 2417, "size_kb": 2.36, "modified_at": "Tue Nov  4 11:58:29 2025", "created_at": "Tue Nov  4 12:01:59 2025", "ext": ".json", "word_count": 179, "top_keywords": ["false", "true", "real", "quite", "meat", "stove", "dark", "lot"]}, "degree": 1, "preview": "{   \"someone\": 1794271337,   \"slide\": 1917366740.6820364,   \"dark\": \"however\",   \"substance\": {     \"wealth\": 1174622014,     \"needs\": 1045740936,     \"love\": false,     \"place\": [       \"reason\",       false,       \"pain\",       \"stove\",       false,       false,       \"thank\",       false,       1312595752,       \"identity\",       \"such\",       \"try\",       \"simplest\",       false,       false,       -74516630.19845057,       \"certain\",       \"swimming\",       2042844988,       \"grabbed\",       false,       -2078604053.5433674,       1373090049,       -822409970.4919887,       true,       -111472615.25488901,       -599905162.6849608,       \"brief\",       \"think\",       true,       true,       false,       \"box\",       \"glad\",       -947049023     ],     \"paper\": -961407510,     \"from\": "}, {"id": "7", "title": "sample3.txt", "type": "file", "path": "D:\\taskfol\\sample3.txt", "words": 1, "size_kb": 5.0, "keywords": [], "metadata": {"filename": "sample3.txt", "filepath": "D:\\taskfol\\sample3.txt", "size_bytes": 5120, "size_kb": 5.0, "modified_at": "Tue Nov  4 11:54:35 2025", "created_at": "Tue Nov  4 12:01:59 2025", "ext": ".txt", "word_count": 1, "top_keywords": []}, "degree": 2, "preview": "atcdtfajokeaojyqdnvaxdccywqehyozohqfnsjrgvqpnbsguqgpvyfggonhvyqkbzbbuioyqyphojjbvexnyrpbykukcxdvpzjqnpqkivfvppxnblsaghppnpdkiroxwacphzejxwwddahhruaelygzhaaiaheklnlslryohmeovczqccbttzdhyxhjelfggypqodrpqgukwhkmkitmkxarwkbefbvwsqjgmbtfakhvvaphmuwugmxtnllzwufavwivxuebzjxyvqevdhfpdgzexziuhokvqlbynfadathvmemeqdehdamyqvqjunziynzfhucycdbeiupufwmwxewuihfsutlhuvoczczdlzyeskqnqmbfpqzsytlfmhmaggrhjjineumhonycnyvtwjttxrkystwvmwzddvrzdxjcffyasproyqssyhwptbfbtogrymydzlvvzvkyribllbjvdbxpljzpjngqxsisrvfijpxzwqixopzmpydluxnmyyuvuhtygczariltpfnqchngwijgkrwhodmzidirtoasrkhzdveistcwbszpegwwbjotmdcdcmjtselzkguvrqddqruaptkfpemyxmvlxplocbfdrsxdspbhmufiookiyigbrmoijvdmfjqicbmpvuvenngycchwjlhxkqtsdjhkapzvkikuucwfjrqupyuwpjaxubtjyudogdjrhnxyqerxrxudzilzzgfxhxweeqtkhzpivtjlzrutvtbsckevbbcjtsygrboufvshooxptnikxytbiqcl"}, {"id": "8", "title": "SBI_in.pdf", "type": "file", "path": "D:\\taskfol\\SBI_in.pdf", "words": 24548, "size_kb": 1357.01, "keywords": ["insured", "policy", "vehicle", "sbi", "company", "maharashtra", "insurance", "shall", "loss", "damage"], "metadata": {"filename": "SBI_in.pdf", "filepath": "D:\\taskfol\\SBI_in.pdf", "size_bytes": 1389581, "size_kb": 1357.01, "modified_at": "Fri Oct 31 11:56:17 2025", "created_at": "Tue Nov  4 11:51:39 2025", "ext": ".pdf", "word_count": 24548, "top_keywords": ["insured", "policy", "vehicle", "sbi", "company", "maharashtra", "insurance", "shall"]}, "degree": 1, "preview": "SBI General Insurance Company Limited Whereas the Insured by a proposal and declaration dated as stated in  the Schedule which shall be the basis of this contract and is deemed  to be incorporated herein has applied to SBI GENERAL INSURANCE  COMPANY LIMITED (hereinafter called ‚Äúthe Company‚Äù) for the  insurance hereinafter contained and has paid the premium  mentioned in the Schedule as consideration for such Insurance to the  Company and which has been realized by the Company in respect of  accidental loss or damage occurring during the Policy Period as  stated in the schedule. The term private car shall include Private Car Type Vehicles used for  social, domestic and pleasure purposes and also for professional  purposes (excluding the carriage of goods other than samples) of the  insured "}, {"id": "9", "title": "SEBI Booklet.pdf", "type": "file", "path": "D:\\taskfol\\SEBI Booklet.pdf", "words": 8943, "size_kb": 634.26, "keywords": ["securities", "investors", "stock", "account", "sebi", "market", "investment", "funds", "shares", "investor"], "metadata": {"filename": "SEBI Booklet.pdf", "filepath": "D:\\taskfol\\SEBI Booklet.pdf", "size_bytes": 649479, "size_kb": 634.26, "modified_at": "Sat Nov  1 10:31:34 2025", "created_at": "Tue Nov  4 11:51:39 2025", "ext": ".pdf", "word_count": 8943, "top_keywords": ["securities", "investors", "stock", "account", "sebi", "market", "investment", "funds"]}, "degree": 1, "preview": "Sr. Index         Page No. No. 1. Introduction 1 2. Regulatory Framework for Securities Market 1 3. What is a Securities Market? 2 4. Primary Market and Secondary Market 4 5. Who are the Market Infrastructure Institutions 6 and Market Intermediaries in the Securities  Market? 6. Basics of Investing 7 7. Key Risks in Investing in Securities Market 8 8. Pre-requisites for investing in Securities 9 Market 9. Basic Services Demat Account (BSDA) 11 10. Procedure for opening an account:  11 Know Your Client (KYC) process 11. Power of Attorney 12 12. Nomination 13 13. How do I invest in securities market? 13 14. Investment through Primary Market 13 15. Process of investing in Primary Market 14 16. Application Supported by Blocked Amount 15 (ASBA)  17. Investment through Secondary Market 15 18. Tr"}, {"id": "10", "title": "0e21835a42a6df2405496f62647058ff855743c1.pdf", "type": "file", "path": "D:\\taskfolder_1\\0e21835a42a6df2405496f62647058ff855743c1.pdf", "words": 1907, "size_kb": 1194.53, "keywords": ["data", "incident", "humanitarian", "incidents", "management", "risk", "organizations", "security", "centre", "organization"], "metadata": {"filename": "0e21835a42a6df2405496f62647058ff855743c1.pdf", "filepath": "D:\\taskfolder_1\\0e21835a42a6df2405496f62647058ff855743c1.pdf", "size_bytes": 1223197, "size_kb": 1194.53, "modified_at": "Tue Nov 11 15:34:46 2025", "created_at": "Thu Apr 25 07:24:40 2024", "ext": ".pdf", "word_count": 1907, "top_keywords": ["data", "incident", "humanitarian", "incidents", "management", "risk", "organizations", "security"]}, "degree": 2, "preview": "THE CENTRE FOR HUMANITARIAN DATA  1 AUGUST 2019WHAT IS A DATA INCIDENT IN HUMANITARIAN RESPONSE? In the humanitarian sector, data incidents are events involving the management of data that have caused  harm or have the potential to cause harm to crisis affected populations, humanitarian organisations and their operations, and other individuals or groups. These events can exploit or exacerbate existing vulnerabilities. 1 In some cases, they may also create new vulnerabilities that can increase the risk of future  data incidents.  Humanitarians have not had a common understanding of what comprises a data incident, nor is there  a minimum technical standard for how these incidents should be prevented and managed. How the humanitarian sector develops tools and implements procedures for data in"}, {"id": "11", "title": "281928eff64137efdd144a833c81ad0ee45284c1.pdf", "type": "file", "path": "D:\\taskfolder_1\\281928eff64137efdd144a833c81ad0ee45284c1.pdf", "words": 2212, "size_kb": 1383.24, "keywords": ["rainfall", "data", "observational", "chirps", "precipitation", "satellite", "arc2", "datasets", "climate", "rain"], "metadata": {"filename": "281928eff64137efdd144a833c81ad0ee45284c1.pdf", "filepath": "D:\\taskfolder_1\\281928eff64137efdd144a833c81ad0ee45284c1.pdf", "size_bytes": 1416434, "size_kb": 1383.24, "modified_at": "Tue Nov 11 15:36:04 2025", "created_at": "Thu Apr 25 07:24:42 2024", "ext": ".pdf", "word_count": 2212, "top_keywords": ["rainfall", "data", "observational", "chirps", "precipitation", "satellite", "arc2", "datasets"]}, "degree": 2, "preview": "1 CENTRE FOR HUMANITARIAN DATA  2 CENTRE FOR HUMANITARIAN DATAAbout this series: The climate crisis is intensifying humanitarian emergencies around the world and  humanitarians  are increasingly having to incorporate  climate data and forecasts into their analysis  and planning. This guidance  series has been developed to help humanitarians  to access,  analyze and  interpret  common types of climate and weather data, and to provide a common language for working  with meteorological  and hydrological services. ‚Ä¢ Observational rainfall data such as CHIRPS or ARC2 captures how much rain has fallen over a defined period of time. ‚Ä¢ The rainfall is measured at weather stations or estimated through satellite or radar imagery . ‚Ä¢ The data can be presented as the total amount of rainfall observed "}, {"id": "12", "title": "2RE7KOL5KV5FFCUG6CYUVEFF4KIUZN2V.pdf", "type": "file", "path": "D:\\taskfolder_1\\2RE7KOL5KV5FFCUG6CYUVEFF4KIUZN2V.pdf", "words": 2686, "size_kb": 542.77, "keywords": ["said", "dec", "2007", "delta", "estuary", "hesaid", "marcia", "bay", "game", "ing"], "metadata": {"filename": "2RE7KOL5KV5FFCUG6CYUVEFF4KIUZN2V.pdf", "filepath": "D:\\taskfolder_1\\2RE7KOL5KV5FFCUG6CYUVEFF4KIUZN2V.pdf", "size_bytes": 555800, "size_kb": 542.77, "modified_at": "Tue Nov 11 15:37:27 2025", "created_at": "Tue Nov 11 15:36:59 2025", "ext": ".pdf", "word_count": 2686, "top_keywords": ["said", "dec", "2007", "delta", "estuary", "hesaid", "marcia", "bay"]}, "degree": 2, "preview": "AGREENER BLUE?  Conference wrapup ......... 3 POLLUTION  Conference, cont‚Äôd .......... 6 RESTORATION  Conference, cont‚Äôd .......... 8 LAND USE  Conference, cont‚Äôd .......... 9 LADY LINCHPIN RETIRES .................. 10 INSIDE SOILED  Shortlybefore8:30a.m.onWednesday,  November7,thecargoshipCoscoBusan‚Äîen  routetoSouthKoreafromthePortofOakland‚Äî  ranintoasupportpostfortheBayBridge,  gashingitsfueltankandsending58,000gallons  ofoilintoSanFranciscoBay.Initialreportsbythe  shippingcompanyputthesizeofthespillat400  gallons.Twelvehourslater,localofficialslearned  theresultsofaninitialinvestigationbystateand  federalagencies‚Äîthatthespillwasover100  timesthesizefirstreported. Whenthosefirstoilydropshitthewater,no  boomswereinplacearoundtheship.Soswirling  Baycurrentsspreadtheoilfarandwide‚Äîhitting  "}, {"id": "13", "title": "customers-100.csv", "type": "file", "path": "D:\\taskfolder_1\\customers-100.csv", "words": 2361, "size_kb": 16.86, "keywords": ["com", "http", "2021", "001", "www", "2020", "https", "org", "2022", "info"], "metadata": {"filename": "customers-100.csv", "filepath": "D:\\taskfolder_1\\customers-100.csv", "size_bytes": 17261, "size_kb": 16.86, "modified_at": "Tue Nov 11 15:39:17 2025", "created_at": "Tue Nov 11 15:39:43 2025", "ext": ".csv", "word_count": 2361, "top_keywords": ["com", "http", "2021", "001", "www", "2020", "https", "org"]}, "degree": 2, "preview": "DD37Cf93aecA6Dc | Sheryl | Baxter | Rasmussen Group | East Leonard | Chile | 229.077.5154 | 397.884.0519x718 | zunigavanessa@smith.info | 2020-08-24 | http://www.stephenson.com/ 1Ef7b82A4CAAD10 | Preston | Lozano | Vega-Gentry | East Jimmychester | Djibouti | 5153435776 | 686-620-1820x944 | vmata@colon.com | 2021-04-23 | http://www.hobbs.com/ 6F94879bDAfE5a6 | Roy | Berry | Murillo-Perry | Isabelborough | Antigua and Barbuda | +1-539-402-0259 | (496)978-3969x58947 | beckycarr@hogan.com | 2020-03-25 | http://www.lawrence.com/ 5Cef8BFA16c5e3c | Linda | Olsen | Dominguez, Mcmillan and Donovan | Bensonview | Dominican Republic | 001-808-617-6467x12895 | +1-813-324-8756 | stanleyblackwell@benson.org | 2020-06-02 | http://www.good-lyons.com/ 053d585Ab6b3159 | Joanna | Bender | Martin, Lang and A"}, {"id": "14", "title": "US_STATE_recipes.json", "type": "file", "path": "D:\\taskfolder_1\\US_STATE_recipes.json", "words": 905354, "size_kb": 6122.06, "keywords": ["cup", "mg", "teaspoon", "sugar", "lemon", "recipe", "salt", "minutes", "pepper", "nan"], "metadata": {"filename": "US_STATE_recipes.json", "filepath": "D:\\taskfolder_1\\US_STATE_recipes.json", "size_bytes": 6268992, "size_kb": 6122.06, "modified_at": "Tue Nov 11 15:45:34 2025", "created_at": "Sun Feb 26 09:54:40 2023", "ext": ".json", "word_count": 905354, "top_keywords": ["cup", "mg", "teaspoon", "sugar", "lemon", "recipe", "salt", "minutes"]}, "degree": 1, "preview": "{   \"0\": {     \"Contient\": \"Africa\",     \"Country_State\": NaN,     \"cuisine\": \"Missouri\",     \"title\": \"Ground Beef and Cabbage\",     \"URL\": \"https://www.allrecipes.com/recipe/229324/ground-beef-and-cabbage/\",     \"rating\": 4.5,     \"total_time\": 60,     \"prep_time\": 15,     \"cook_time\": 45,     \"description\": \"This ground beef and cabbage recipe combines lean ground beef, cabbage, onion, and tomatoes with simple seasonings for a hearty and comforting dish.\",     \"ingredients\": [       \"1 large head cabbage, finely chopped\",       \"1 (14.5 ounce) can diced tomatoes with juice\",       \"1 onion, halved and thinly sliced\",       \"1 tablespoon Italian seasoning\",       \"salt and ground black pepper to taste\",       \"1 pound lean ground beef\"     ],     \"instructions\": [       \"Place cabbage, t"}, {"id": "15", "title": "0e21835a42a6df2405496f62647058ff855743c1.pdf", "type": "file", "path": "D:\\taskfolder_2\\0e21835a42a6df2405496f62647058ff855743c1.pdf", "words": 1907, "size_kb": 1194.53, "keywords": ["data", "incident", "humanitarian", "incidents", "management", "risk", "organizations", "security", "centre", "organization"], "metadata": {"filename": "0e21835a42a6df2405496f62647058ff855743c1.pdf", "filepath": "D:\\taskfolder_2\\0e21835a42a6df2405496f62647058ff855743c1.pdf", "size_bytes": 1223197, "size_kb": 1194.53, "modified_at": "Tue Nov 11 15:34:46 2025", "created_at": "Wed Nov 12 12:50:51 2025", "ext": ".pdf", "word_count": 1907, "top_keywords": ["data", "incident", "humanitarian", "incidents", "management", "risk", "organizations", "security"]}, "degree": 2, "preview": "THE CENTRE FOR HUMANITARIAN DATA  1 AUGUST 2019WHAT IS A DATA INCIDENT IN HUMANITARIAN RESPONSE? In the humanitarian sector, data incidents are events involving the management of data that have caused  harm or have the potential to cause harm to crisis affected populations, humanitarian organisations and their operations, and other individuals or groups. These events can exploit or exacerbate existing vulnerabilities. 1 In some cases, they may also create new vulnerabilities that can increase the risk of future  data incidents.  Humanitarians have not had a common understanding of what comprises a data incident, nor is there  a minimum technical standard for how these incidents should be prevented and managed. How the humanitarian sector develops tools and implements procedures for data in"}, {"id": "16", "title": "281928eff64137efdd144a833c81ad0ee45284c1.pdf", "type": "file", "path": "D:\\taskfolder_2\\281928eff64137efdd144a833c81ad0ee45284c1.pdf", "words": 2212, "size_kb": 1383.24, "keywords": ["rainfall", "data", "observational", "chirps", "precipitation", "satellite", "arc2", "datasets", "climate", "rain"], "metadata": {"filename": "281928eff64137efdd144a833c81ad0ee45284c1.pdf", "filepath": "D:\\taskfolder_2\\281928eff64137efdd144a833c81ad0ee45284c1.pdf", "size_bytes": 1416434, "size_kb": 1383.24, "modified_at": "Tue Nov 11 15:36:04 2025", "created_at": "Wed Nov 12 12:50:51 2025", "ext": ".pdf", "word_count": 2212, "top_keywords": ["rainfall", "data", "observational", "chirps", "precipitation", "satellite", "arc2", "datasets"]}, "degree": 2, "preview": "1 CENTRE FOR HUMANITARIAN DATA  2 CENTRE FOR HUMANITARIAN DATAAbout this series: The climate crisis is intensifying humanitarian emergencies around the world and  humanitarians  are increasingly having to incorporate  climate data and forecasts into their analysis  and planning. This guidance  series has been developed to help humanitarians  to access,  analyze and  interpret  common types of climate and weather data, and to provide a common language for working  with meteorological  and hydrological services. ‚Ä¢ Observational rainfall data such as CHIRPS or ARC2 captures how much rain has fallen over a defined period of time. ‚Ä¢ The rainfall is measured at weather stations or estimated through satellite or radar imagery . ‚Ä¢ The data can be presented as the total amount of rainfall observed "}, {"id": "17", "title": "2RE7KOL5KV5FFCUG6CYUVEFF4KIUZN2V.pdf", "type": "file", "path": "D:\\taskfolder_2\\2RE7KOL5KV5FFCUG6CYUVEFF4KIUZN2V.pdf", "words": 2686, "size_kb": 542.77, "keywords": ["said", "dec", "2007", "delta", "estuary", "hesaid", "marcia", "bay", "game", "ing"], "metadata": {"filename": "2RE7KOL5KV5FFCUG6CYUVEFF4KIUZN2V.pdf", "filepath": "D:\\taskfolder_2\\2RE7KOL5KV5FFCUG6CYUVEFF4KIUZN2V.pdf", "size_bytes": 555800, "size_kb": 542.77, "modified_at": "Tue Nov 11 15:37:27 2025", "created_at": "Wed Nov 12 12:50:51 2025", "ext": ".pdf", "word_count": 2686, "top_keywords": ["said", "dec", "2007", "delta", "estuary", "hesaid", "marcia", "bay"]}, "degree": 2, "preview": "AGREENER BLUE?  Conference wrapup ......... 3 POLLUTION  Conference, cont‚Äôd .......... 6 RESTORATION  Conference, cont‚Äôd .......... 8 LAND USE  Conference, cont‚Äôd .......... 9 LADY LINCHPIN RETIRES .................. 10 INSIDE SOILED  Shortlybefore8:30a.m.onWednesday,  November7,thecargoshipCoscoBusan‚Äîen  routetoSouthKoreafromthePortofOakland‚Äî  ranintoasupportpostfortheBayBridge,  gashingitsfueltankandsending58,000gallons  ofoilintoSanFranciscoBay.Initialreportsbythe  shippingcompanyputthesizeofthespillat400  gallons.Twelvehourslater,localofficialslearned  theresultsofaninitialinvestigationbystateand  federalagencies‚Äîthatthespillwasover100  timesthesizefirstreported. Whenthosefirstoilydropshitthewater,no  boomswereinplacearoundtheship.Soswirling  Baycurrentsspreadtheoilfarandwide‚Äîhitting  "}, {"id": "18", "title": "customers-100.csv", "type": "file", "path": "D:\\taskfolder_2\\customers-100.csv", "words": 2361, "size_kb": 16.86, "keywords": ["com", "http", "2021", "001", "www", "2020", "https", "org", "2022", "info"], "metadata": {"filename": "customers-100.csv", "filepath": "D:\\taskfolder_2\\customers-100.csv", "size_bytes": 17261, "size_kb": 16.86, "modified_at": "Tue Nov 11 15:39:17 2025", "created_at": "Wed Nov 12 12:50:51 2025", "ext": ".csv", "word_count": 2361, "top_keywords": ["com", "http", "2021", "001", "www", "2020", "https", "org"]}, "degree": 2, "preview": "DD37Cf93aecA6Dc | Sheryl | Baxter | Rasmussen Group | East Leonard | Chile | 229.077.5154 | 397.884.0519x718 | zunigavanessa@smith.info | 2020-08-24 | http://www.stephenson.com/ 1Ef7b82A4CAAD10 | Preston | Lozano | Vega-Gentry | East Jimmychester | Djibouti | 5153435776 | 686-620-1820x944 | vmata@colon.com | 2021-04-23 | http://www.hobbs.com/ 6F94879bDAfE5a6 | Roy | Berry | Murillo-Perry | Isabelborough | Antigua and Barbuda | +1-539-402-0259 | (496)978-3969x58947 | beckycarr@hogan.com | 2020-03-25 | http://www.lawrence.com/ 5Cef8BFA16c5e3c | Linda | Olsen | Dominguez, Mcmillan and Donovan | Bensonview | Dominican Republic | 001-808-617-6467x12895 | +1-813-324-8756 | stanleyblackwell@benson.org | 2020-06-02 | http://www.good-lyons.com/ 053d585Ab6b3159 | Joanna | Bender | Martin, Lang and A"}];
  const FOLDER_LABELS = ["taskfol", "taskfolder_1", "taskfolder_2"];
  const FOLDER_IDS = ["F1", "F2", "F3"];
  const BAR_VALUES = [699981, 914520, 9166];
  const LINE_VALUES = [188732, 9599, 77];
  const TOP_KEYWORDS = ["nan", "dollars", "millions", "services", "total", "assets"];

  // ------------------ Build vis-network ------------------
  const container = document.getElementById('mynetwork');
  const data = {
    nodes: new vis.DataSet(NODES),
    edges: new vis.DataSet(EDGES)
  };
  const options = {
    physics: {
      solver: 'barnesHut',
      barnesHut: {
        gravitationalConstant: -3000,
        centralGravity: 0.2,
        springLength: 160,
        springConstant: 0.04,
        damping: 0.2
      },
      stabilization: { iterations: 250 }
    },
    nodes: {
      shape: 'dot',
      scaling: { min: 6, max: 60 },
      borderWidthSelected: 3,
      font: { color: '#eaf6ff', size: 12 },
    },
    edges: { smooth: { type:'dynamic' }, hoverWidth: 1.5 },
    interaction: { hover: true, tooltipDelay: 80, navigationButtons: true, keyboard: true }
  };
  const network = new vis.Network(container, data, options);

  // utility: pretty-print JSON metadata block
  function prettyJSON(obj) {
    try {
      return JSON.stringify(obj, null, 2)
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;');
    } catch(e) {
      return String(obj);
    }
  }

  // show portrait for id (folder or file)
  function showPortrait(id) {
    const it = DETAILS.find(x => x.id === id);
    if (!it) return;
    let html = `<div>`;
    if (it.type === "folder") {
      html += `<div class="kv"><b>Folder</b><div style="font-weight:700">${_escape(it.title)}</div></div>`;
      html += `<div class="kv"><b>Path</b><div>${_escape(it.path)}</div></div>`;
      html += `<div class="kv"><b>Files</b><div>${it.file_count}</div></div>`;
      html += `<div class="kv"><b>Words</b><div>${it.words}</div></div>`;
      html += `<div class="kv"><b>Top keywords</b><div class="chips">${(it.keywords||[]).map(k=>'<span class="chip">'+_escape(k)+'</span>').join(' ')}</div></div>`;
      html += `<div class="divider"></div>`;
      html += `<div style="font-weight:600;color:#8bd8ff;margin-bottom:6px">Metadata</div>`;
      html += `<div class="meta-block">${prettyJSON(it.metadata)}</div>`;
      html += `<div class="divider"></div>`;
      html += `<div style="font-weight:600;color:#8bd8ff;margin-bottom:6px">Contains (sample)</div>`;
      // show up to 25 contained docs
      const children = data.edges.get().filter(e => e.from === id).map(e => data.nodes.get(e.to)).filter(Boolean);
      html += `<div class="muted">${children.slice(0,25).map(c=>'<div style="margin:6px 0">‚Ä¢ <b>'+_escape(c.label)+'</b> <span style="color:#9fb6cc">('+(c.group)+')</span></div>').join('')}</div>`;
    } else {
      html += `<div class="kv"><b>File</b><div style="font-weight:700">${_escape(it.title)}</div></div>`;
      html += `<div class="kv"><b>Folder</b><div>${_escape(it.metadata && it.metadata.filepath ? it.metadata.filepath.replace(it.title,'') : '‚Äî')}</div></div>`;
      html += `<div class="kv"><b>Type</b><div>${_escape(it.metadata && it.metadata.ext ? it.metadata.ext : '‚Äî')}</div></div>`;
      html += `<div class="kv"><b>Size (KB)</b><div>${_escape(it.size_kb)}</div></div>`;
      html += `<div class="kv"><b>Words</b><div>${it.words}</div></div>`;
      html += `<div class="kv"><b>Degree</b><div>${it.degree}</div></div>`;
      html += `<div class="kv"><b>Keywords</b><div class="chips">${(it.keywords||[]).map(k=>'<span class="chip">'+_escape(k)+'</span>').join(' ')}</div></div>`;
      html += `<div class="divider"></div>`;
      html += `<div style="font-weight:600;color:#8bd8ff;margin-bottom:6px">Metadata</div>`;
      html += `<div class="meta-block">${prettyJSON(it.metadata)}</div>`;
      html += `<div class="divider"></div>`;
      html += `<div style="font-weight:600;color:#8bd8ff;margin-bottom:6px">Preview</div>`;
      html += `<div style="line-height:1.45;color:#dfeaf8">${_escape(it.preview || '‚Äî')}</div>`;
    }
    html += `</div>`;
    document.getElementById('portrait').innerHTML = html;
  }

  // small helper for safe text injection
  function _escape(s) {
    if (s === null || s === undefined) return '';
    return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
  }

  // select & highlight neighbors on node select
  network.on("selectNode", function(params) {
    if (!params.nodes || params.nodes.length === 0) return;
    const nid = params.nodes[0];
    const connEdges = data.edges.get({ filter: e => e.from === nid || e.to === nid });
    const neighborIds = new Set([nid]);
    connEdges.forEach(e => { neighborIds.add(e.from); neighborIds.add(e.to); });
    data.nodes.forEach(n => {
      data.nodes.update({ id: n.id, opacity: neighborIds.has(n.id) ? 1.0 : 0.12 });
    });
    showPortrait(nid);
  });

  network.on("deselectNode", function() {
    data.nodes.forEach(n => data.nodes.update({ id: n.id, opacity: 1.0 }));
    document.getElementById('portrait').innerHTML = '<div class="muted">Click a folder or file to view details here.</div>';
  });

  // ------------------ Plotly chart (folder-level) ------------------
  const traceBar = {
    x: FOLDER_LABELS,
    y: BAR_VALUES,
    type: 'bar',
    name: 'Words',
    marker: { line: { width: 0 } }
  };
  const traceLine = {
    x: FOLDER_LABELS,
    y: LINE_VALUES,
    type: 'scatter',
    mode: 'lines+markers',
    name: 'Keyword Freq',
    yaxis: 'y2'
  };
  const layout = {
    paper_bgcolor: '#071019',
    plot_bgcolor: '#071019',
    font: { color: '#e6eef8' },
    margin: { l: 60, r: 60, t: 12, b: 200 },
    xaxis: { tickangle: -35, automargin: true },
    yaxis: { title: 'Words', gridcolor: '#0e2a35' },
    yaxis2: { title: 'Keyword Freq', overlaying: 'y', side: 'right', gridcolor: 'rgba(0,0,0,0)' },
    hovermode: 'x unified'
  };
  Plotly.newPlot('chart', [traceBar, traceLine], layout, {displayModeBar: true, responsive: true});

  // clicking a bar navigates to that folder node
  const plotDiv = document.getElementById('chart');
  plotDiv.on('plotly_click', function(eventData) {
    try {
      const point = eventData.points[0];
      const idx = point.pointIndex;
      const fid = FOLDER_IDS[idx];
      // focus the folder node in the network and show portrait
      network.focus(fid, {scale:1.3, animation:true});
      showPortrait(fid);
      // visually highlight (temporarily increase size)
      const node = data.nodes.get(fid);
      if (node) {
        data.nodes.update({ id: fid, value: node.value * 1.2 });
        setTimeout(()=>data.nodes.update({ id: fid, value: node.value }), 900);
      }
    } catch(e) {
      console.warn("plot click error", e);
    }
  });

  // edge tooltips handled by vis via title property

  // final: fit network nicely
  network.once("stabilizationIterationsDone", function() {
    network.fit({ animation: true });
  });
</script>
</body>
</html>
